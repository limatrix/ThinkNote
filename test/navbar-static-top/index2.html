<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Static Top Navbar Example for Bootstrap</title>

    <!-- Bootstrap core CSS -->
    <link href="../bootstrap-3.3.5/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- <script src="../bootstrap-3.3.5/dist/js/bootstrap.min.js"></script> -->

    <!-- Custom styles for this template -->
    <link href="navbar-static-top.css" rel="stylesheet">

    
    <link href="perfect-scrollbar.min.css" rel="stylesheet">
    <script src="jquery.min.js"></script>
    <script src="perfect-scrollbar.jquery.min.js"></script>
    <style>
	  /*.contentHolder { 
	    position:relative; overflow: auto;
	  }*/
.container {
	width: 98%;
}
  .contentHolder { position:relative; overflow:auto; width:100%;}

	  p {
	  	font-size: 16px;
    line-height: 1.65;
    margin: 1em 1em 1em 0em;
    display: block;
    padding: 0.4em 0em 0.4em 0.2em;
/*    -webkit-margin-before: 1em;
    -webkit-margin-after: 1em;
    -webkit-margin-start: 0px;
    -webkit-margin-end: 0px;*/
	  }

	  .title-border {
/*  		border-right-width:15px;
  		border-right-style:solid;
  		border-right-color:#aaa;*/
  		border-right:3px solid #aaa; 
	  }

    .center {
      display:table; width:auto; margin-left:auto; margin-right:auto;
    }

	</style>
	<style>

    </style>
  </head>

  <body>
    <!-- $(".chatList").scrollTop($(".chatList")[0].scrollHeight); -->
    <!-- Static navbar -->
<!--     <nav class="navbar navbar-default navbar-static-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">Project name</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="active"><a href="#">Home</a></li>
            <li><a href="#about">About</a></li>
            <li><a href="#contact">Contact</a></li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Dropdown <span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li><a href="#">Action</a></li>
                <li><a href="#">Another action</a></li>
                <li><a href="#">Something else here</a></li>
                <li role="separator" class="divider"></li>
                <li class="dropdown-header">Nav header</li>
                <li><a href="#">Separated link</a></li>
                <li><a href="#">One more separated link</a></li>
              </ul>
            </li>
          </ul>
          <ul class="nav navbar-nav navbar-right">
            <li><a href="../navbar/">Default</a></li>
            <li class="active"><a href="./">Static top <span class="sr-only">(current)</span></a></li>
            <li><a href="../navbar-fixed-top/">Fixed top</a></li>
          </ul>
        </div>
      </div>
    </nav> -->


<div class="container">
  <!-- 标题 -->
	<div class="row clearfix">
		<div class="col-md-12">
			<form role="form">
				<div class="form-group">
					 <input class="form-control" id="articleTitle" type="text"/>
				</div>
			</form>
      <div>
        关键字
      </div>
		</div>
	</div>

  <!-- 问题记录 -->
  <!-- 滚动条: 需要样式contentHolder, 需要固定高度$('#content').height(winHeight - offset - 100);-->
  <!-- bootstrap居中: style="display:table; width:auto; margin-left:auto; margin-right:auto"  -->
  <!-- perfect 默认显示滚动条：always-visible -->
  <!-- 监听resize：$(window).resize(function() {});  -->
  <!-- 隐藏滚动条：overflow:hidden -->
  <div class="row clearfix">
    <div id="Demo" class="col-md-3">
      <div id="content" class="contentHolder"> 
  		  
        <p seq="1" contentEditable="true">点此添加标题</p>
        <p seq="2" contentEditable="true">点此添加标题</p>
        <p seq="3" contentEditable="true">点此添加标题</p>
        <p seq="4" contentEditable="true">点此添加标题</p>
        <p seq="5" contentEditable="true">点此添加标题</p>
        <p seq="6" contentEditable="true">点此添加标题</p>
        <button class="btn btn-primary center" onclick="addTitle(this)">添加标题</button>
        
      <!-- </div> -->

      <!-- <div id="titleOpt" class="center"> -->
		  	<button class="btn btn-primary">编辑</button>
        &nbsp;&nbsp;&nbsp;&nbsp;
		  	<button class="btn btn-primary">排序</button>
	     </div>
      
    </div>
    <div id="col-content-right" class="col-md-9">
      xxx<br />xxx<br />xxx<br />xxx<br />xxx<br />
    </div>
  </div>
</div>

<!-- /container -->

<!-- <form role="form">
<div class="form-group">
<input class="form-control" id="articleTitle" type="text" placeholder="在此输入段落标题" />
</div>
</form> -->

    
  </body>
<script type="text/javascript">
var g_winHeight = 0;

$(document).ready(function() {

// 控件高度设置
	var winHeight = $(window).height(); //浏览器当前窗口可视区域高度
	var offset = $("#content").offset().top;
  g_winHeight = winHeight;
	$('#content').height(winHeight - offset);
  //$('#Demo').height(winHeight - offset -100);
  //$('#content').attr('min-height', winHeight - offset - 30 + 'px');

	// <p>的Onclick事件，如果是"点此添加标题"才清空
	$("#content").on("click","p", function(){
	  //alert($(this).attr("seq"));
	  if($(this).text() == "点此添加标题") {
	  	$(this).text("");
	  }
	});

	// 失去焦点
	$("#content").on("blur","p", function(){
	  if($(this).text() == "") {
	  	$(this).text("点此添加标题");
	  }
	});

	//滚动条
	$('#content').perfectScrollbar(); 
}); 

  // 窗口变化时需要
  // 1. 重新计算标题栏高度，因为滚动条需要明确的高度
  // 2. 更新滚动条
  $(window).resize(function() {
    var winHeight = $(window).height(); //浏览器当前窗口可视区域高度
    var offset = $("#content").offset().top;
    $('#content').height(winHeight - offset - 80);
    $('#content').perfectScrollbar("update"); 
  });

  // 需计算seq值
  function addTitle(obj) {
    var count = $("#content p").length;
    var nextSeq = count + 1;
    //$("#content").append("<p seq=\""+nextSeq+"\" contentEditable=\"true\">点此添加标题</p>");
    $("<p seq=\""+nextSeq+"\" contentEditable=\"true\">点此添加标题</p>").insertBefore($(obj));
    $('#content').perfectScrollbar("update"); 
    // var offset = $(obj).offset().top;
    // if(g_winHeight - offset < 150) {
    //   alert('aaa');
    // }
    var divHeight = $("#content").height();
    if($('#content').prop("scrollHeight") > divHeight) {
      $('#content').scrollTop($('#content').prop("scrollHeight") - divHeight + 100);
      $('#content').perfectScrollbar("update"); 
    }  
    //alert('divHeight: '+divHeight);
    //alert('scrollTop:'+$('#content').scrollTop()+'scrollHeight:'+$('#content').prop("scrollHeight"));
  }

</script>
</html>
